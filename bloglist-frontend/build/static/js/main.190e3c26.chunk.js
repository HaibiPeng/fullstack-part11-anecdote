(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{120:function(e,t,n){},121:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n(0),a=n.n(c),i=n(12),s=n.n(i),o=n(7),u=n.n(o),l=n(11),d=n(47),j=n(80),b=n(24),p=n.n(b),h="/api/blogs",O=null,f={getAll:function(){return p.a.get(h).then((function(e){return e.data}))},create:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:O}},e.next=3,p.a.post(h,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){O="bearer ".concat(e)},addLikes:function(e){return p.a.put("".concat(h,"/").concat(e.id),e).then((function(e){return e.data}))},deleteBlog:function(e){var t={headers:{Authorization:O}};return p.a.delete("".concat(h,"/").concat(e),t).then((function(e){return e.data}))},addComment:function(e,t){return p.a.post("".concat(h,"/").concat(e,"/comments"),t).then((function(e){return e.data}))}},x=function(e){return function(){var t=Object(l.a)(u.a.mark((function t(n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.id,n({type:"ADD_LIKES",data:{id:r}}),t.next=4,f.addLikes(Object(d.a)(Object(d.a)({},e),{},{likes:e.likes+1}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},v=function(e){return function(){var t=Object(l.a)(u.a.mark((function t(n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.id,n({type:"DELETE_BLOG",data:{id:r}}),t.next=4,f.deleteBlog(r);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},m=function(e,t){return function(){var n=Object(l.a)(u.a.mark((function n(r){var c;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f.addComment(e,t);case 2:c=n.sent,r({type:"ADD_COMMENT",data:c});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW_BLOG":return[].concat(Object(j.a)(e),[t.data]);case"INIT_BLOGS":return t.data;case"ADD_LIKES":var n=t.data.id,r=e.find((function(e){return e.id===n})),c=Object(d.a)(Object(d.a)({},r),{},{likes:r.likes+1});return e.map((function(e){return e.id!==n?e:c}));case"DELETE_BLOG":var a=t.data.id;return e.filter((function(e){return e.id!==a}));case"ADD_COMMENT":return e.map((function(e){return e.id!==t.data.id?e:t.data}));default:return e}};function w(e,t){return{type:e,data:{content:t}}}var y=[],k=function(e,t){return function(n){n(w("SUCCESS_NOTIFICATION",e)),y=y.concat(setTimeout((function(){n({type:"REMOVE_NOTIFICATION"})}),1e3*t)),window.clearTimeout(y[y.length-2])}},E=function(e,t){return function(n){n(w("ERROR_NOTIFICATION",e)),y=y.concat(setTimeout((function(){n({type:"REMOVE_NOTIFICATION"})}),1e3*t)),window.clearTimeout(y[y.length-2])}},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{message:"",toShow:!1,notitype:""},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SUCCESS_NOTIFICATION":return{message:"".concat(t.data.content),toShow:!0,notitype:!0};case"ERROR_NOTIFICATION":return{message:"".concat(t.data.content),toShow:!0,notitype:!1};case"REMOVE_NOTIFICATION":return{message:"",toShow:!1};default:return e}},I={login:function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},N={signup:function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("/api/users",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},S=function(e,t){return function(){var n=Object(l.a)(u.a.mark((function n(r){var c;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,I.login({username:e,password:t});case 2:c=n.sent,window.localStorage.setItem("loggedBlogappUser",JSON.stringify(c)),f.setToken(c.token),r({type:"SET_TOKEN",user:c});case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},C=function(e,t,n){return function(){var r=Object(l.a)(u.a.mark((function r(c){var a;return u.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,N.signup({username:e,name:t,password:n});case 2:a=r.sent,console.log(a),c({type:"SIGN_UP",msg:a});case 5:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SIGN_UP":return t.msg;case"SET_TOKEN":case"GET_TOKEN":return t.user;case"REMOVE_TOKEN":return null;default:return e}},L=function(){return p.a.get("/api/users").then((function(e){return e.data}))},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return t.data;default:return e}},R=n(35),D=n(73),A=n(75),U=Object(R.combineReducers)({blogs:g,notification:T,user:_,users:B}),G=Object(R.createStore)(U,Object(D.composeWithDevTools)(Object(R.applyMiddleware)(A.a))),M=n(9),F=n(40),K=n(19),P=n(151),V=n(122),q=n(155),J=n(156),W=n(157),z=n(158),H=function(e){var t=e.blog,n=e.user,a=e.addLikes,i=e.deleteBlog,s=Object(c.useState)(!1),o=Object(F.a)(s,2),u=o[0],l=o[1],d={display:u?"none":""},j={display:u?"":"none"},b=function(){l(!u)};return Object(r.jsx)("div",{id:"blog",children:Object(r.jsx)(P.a,{component:V.a,children:Object(r.jsx)(q.a,{children:Object(r.jsx)(J.a,{children:Object(r.jsx)(W.a,{children:Object(r.jsxs)(z.a,{children:[Object(r.jsxs)("div",{style:d,className:"titleandauthor",children:[Object(r.jsxs)(K.b,{to:"/blogs/".concat(t.id),children:[t.title," ",t.author]}),Object(r.jsx)("button",{onClick:b,children:"view"})]}),Object(r.jsxs)("div",{style:j,className:"titleandauthor",children:[t.title," ",t.author,Object(r.jsx)("button",{onClick:b,children:"hide"}),Object(r.jsx)("p",{children:t.url}),"likes ",Object(r.jsx)("span",{className:"likes",children:t.likes}),Object(r.jsx)("button",{id:"addlikes",onClick:function(){return a(t.id)},children:"like"}),Object(r.jsx)("p",{children:void 0===t.user.username?n:t.user.username}),Object(r.jsx)("button",{onClick:function(){return i(t.id)},children:"remove"})]})]})},t.id)})})})})},Y=function(e){var t=e.user,n=Object(M.c)((function(e){return e.blogs})),c=Object(M.b)();return Object(r.jsx)("div",{id:"showblogs",children:n.sort((function(e,t){return parseFloat(t.likes)-parseFloat(e.likes)})).map((function(e){return Object(r.jsx)(H,{blog:e,user:t.username,addLikes:function(){return function(e){var t=n.find((function(t){return t.id===e}));c(x(t))}(e.id)},deleteBlog:function(){return function(e){var r=n.find((function(t){return t.id===e}));window.confirm("Remove blog ".concat(r.title," by ").concat(r.author))&&(r.user.username===t.username||void 0===r.user.username?(c(v(r)),c(k("blog '".concat(r.title,"' by ").concat(r.author," deleted"),5))):f.deleteBlog(e).catch((function(e){c(E(e.response.data.error,5))})))}(e.id)}},e.id)}))})},Q=n(159),X=n(160),Z=a.a.forwardRef((function(e,t){var n=Object(c.useState)(!1),a=Object(F.a)(n,2),i=a[0],s=a[1],o={display:i?"none":""},u={display:i?"":"none"},l=function(){s(!i)};return Object(c.useImperativeHandle)(t,(function(){return{toggleVisibility:l}})),Object(r.jsx)(Q.a,{children:Object(r.jsxs)("div",{children:[Object(r.jsx)("div",{style:o,children:Object(r.jsx)(X.a,{variant:"contained",color:"primary",onClick:l,children:e.buttonLabel})}),Object(r.jsxs)("div",{style:u,children:[e.children,Object(r.jsx)(X.a,{variant:"contained",onClick:l,children:"cancel"})]})]})})})),$=n(164),ee=n(79),te=n.n(ee),ne=function(){var e=Object(M.b)(),t=Object(c.useRef)();return Object(r.jsx)(Q.a,{children:Object(r.jsx)("div",{className:"formDiv",children:Object(r.jsxs)(Z,{buttonLabel:"new blog",ref:t,children:[Object(r.jsx)("h2",{children:"Create a new blog"}),Object(r.jsxs)("form",{onSubmit:function(n){t.current.toggleVisibility(),n.preventDefault();var r=n.target.title.value,c=n.target.author.value,a=n.target.url.value;n.target.title.value="",n.target.author.value="",n.target.url.value="";var i,s={title:r,author:c,url:a};e((i=s,function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.create(i);case 2:n=e.sent,t({type:"NEW_BLOG",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())).then((function(){e(k("a new blog '".concat(s.title,"' by ").concat(s.author," added"),5))})).catch((function(t){e(E(t.response.data.error,5))}))},children:[Object(r.jsx)("div",{children:Object(r.jsx)($.a,{label:"title",placeholder:"title",variant:"outlined",margin:"dense",type:"text",id:"title",name:"title"})}),Object(r.jsx)("div",{children:Object(r.jsx)($.a,{label:"author",placeholder:"author",variant:"outlined",margin:"dense",type:"text",id:"author",name:"author"})}),Object(r.jsx)("div",{children:Object(r.jsx)($.a,{label:"url",placeholder:"url",variant:"outlined",margin:"dense",type:"text",id:"url",name:"url"})}),Object(r.jsx)(X.a,{variant:"contained",color:"primary",startIcon:Object(r.jsx)(te.a,{}),type:"submit",children:"create"})]})]})})})},re=n(16),ce=function(){var e=Object(M.b)(),t=Object(re.f)(),n=function(){var n=Object(l.a)(u.a.mark((function n(r){var c,a;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r.preventDefault(),c=r.target.username.value,a=r.target.password.value,e(S(c,a)).then((function(){e(k("Login succussfully!",5))})).catch((function(t){e(E(t.response.data.error,5))})),t.push("/");case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:"Login to application"}),Object(r.jsx)(Q.a,{children:Object(r.jsxs)("form",{onSubmit:n,children:[Object(r.jsx)("div",{children:Object(r.jsx)($.a,{required:!0,label:"username",placeholder:"username",variant:"outlined",margin:"dense",id:"username",type:"text",name:"username"})}),Object(r.jsx)("div",{children:Object(r.jsx)($.a,{required:!0,label:"password",placeholder:"password",variant:"outlined",margin:"dense",id:"password",type:"password",name:"Password"})}),Object(r.jsx)(X.a,{variant:"contained",color:"primary",id:"login-button",type:"submit",children:"login"})]})})]})},ae=function(){var e=Object(M.b)(),t=Object(re.f)(),n=function(){var n=Object(l.a)(u.a.mark((function n(r){var c,a,i,s;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r.preventDefault(),c=r.target.username.value,a=r.target.name.value,i=r.target.password.value,s=r.target.checkpassword.value,i!==s?e(E("Passwords do not match. Please check again.",5)):e(C(c,a,i)).then((function(){e(k("Sign up succussfully. Go to login.",5))})).catch((function(t){e(E(t.response.data.error,5))})),t.push("/signup");case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:"Signup to application"}),Object(r.jsx)(Q.a,{children:Object(r.jsxs)("form",{onSubmit:n,children:[Object(r.jsx)("div",{children:Object(r.jsx)($.a,{required:!0,label:"Username",placeholder:"username for login",variant:"outlined",margin:"dense",id:"username",type:"text",name:"username"})}),Object(r.jsx)("div",{children:Object(r.jsx)($.a,{required:!0,label:"Name",placeholder:"name for blogs",variant:"outlined",margin:"dense",id:"name",type:"text",name:"name"})}),Object(r.jsx)("div",{children:Object(r.jsx)($.a,{required:!0,label:"Password",placeholder:"password",variant:"outlined",margin:"dense",id:"password",type:"password",name:"password"})}),Object(r.jsx)("div",{children:Object(r.jsx)($.a,{required:!0,label:"Check password",placeholder:"check your password",variant:"outlined",margin:"dense",id:"checkpassword",type:"password",name:"checkpassword"})}),Object(r.jsx)(X.a,{variant:"contained",color:"primary",id:"signup-button",type:"submit",children:"signup"})]})})]})},ie=function(){var e=Object(M.b)(),t=Object(re.f)(),n=function(){var n=Object(l.a)(u.a.mark((function n(r){return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:r.preventDefault(),e(function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.localStorage.removeItem("loggedBlogappUser"),f.setToken(null),t({type:"REMOVE_TOKEN"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e(k("logged out successfully",5)),t.push("/login");case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return Object(r.jsx)("button",{name:"logoutform",onClick:function(e){return n(e)},children:"Logout"})},se=n(165),oe=function(){var e=Object(M.c)((function(e){return e.notification}));return Object(r.jsx)("div",{style:e.toShow?{display:"inline"}:{display:"none"},children:Object(r.jsx)(se.a,{severity:e.notitype?"success":"error",children:e.message})})},ue=n(161),le=function(){var e=Object(M.b)();Object(c.useEffect)((function(){e(function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L();case 2:n=e.sent,t({type:"INIT_USERS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]);var t=Object(M.c)((function(e){return e.users}));return Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:"Users"}),Object(r.jsx)(P.a,{component:V.a,children:Object(r.jsxs)(q.a,{children:[Object(r.jsx)(ue.a,{children:Object(r.jsxs)(W.a,{children:[Object(r.jsx)(z.a,{children:"name"}),Object(r.jsx)(z.a,{children:"blogs"})]})}),Object(r.jsx)(J.a,{children:t.map((function(e){return Object(r.jsxs)(W.a,{children:[Object(r.jsx)(z.a,{children:Object(r.jsx)(K.b,{to:"/users/".concat(e.id),children:e.name})}),Object(r.jsx)(z.a,{children:e.blogs.length})]},e.id)}))})]})})]})},de=function(){var e=Object(M.c)((function(e){return e.users}));console.log(e);var t=Object(re.g)("/users/:id"),n=t?e.find((function(e){return e.id===t.params.id})):null;return n?Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:n.username}),Object(r.jsx)(P.a,{component:V.a,children:Object(r.jsxs)(q.a,{children:[Object(r.jsx)(ue.a,{children:Object(r.jsx)(W.a,{children:Object(r.jsx)(z.a,{children:"added blogs"})})}),Object(r.jsx)(J.a,{children:n.blogs.map((function(e){return Object(r.jsx)(W.a,{children:Object(r.jsx)(z.a,{children:Object(r.jsx)("li",{children:e.title})})},e.id)}))})]})})]}):null},je=function(e){var t=e.id,n=Object(M.b)(),c=function(){var e=Object(l.a)(u.a.mark((function e(r){var c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.preventDefault(),(c=r.target.comment.value)&&(n(m(t,{content:c})),r.target.comment.value="");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)("form",{name:"commentform",onSubmit:c,children:[Object(r.jsx)("input",{id:"comment",type:"text",name:"comment"}),Object(r.jsx)("button",{id:"creating-button",type:"submit",children:"add comment"})]})},be=function(){var e=Object(M.c)((function(e){return[e.blogs,e.user]})),t=Object(F.a)(e,2),n=t[0],c=t[1],a=Object(M.b)(),i=Object(re.f)();console.log(c);var s=Object(re.g)("/blogs/:id"),o=s?n.find((function(e){return e.id===s.params.id})):null;if(console.log(o),!o)return null;return Object(r.jsxs)("div",{id:"blog",children:[Object(r.jsx)("h3",{children:o.title}),Object(r.jsx)("a",{href:o.url,children:o.url}),Object(r.jsxs)("p",{children:["likes ",Object(r.jsx)("span",{className:"likes",children:o.likes}),Object(r.jsx)("button",{id:"addlikes",onClick:function(){return function(e){a(x(e))}(o)},children:"like"})]}),Object(r.jsxs)("p",{children:["added by ",void 0===o.user.username?c.username:o.user.username]}),Object(r.jsx)("button",{onClick:function(){return function(e){window.confirm("Remove blog ".concat(e.title," by ").concat(e.author))&&(void 0===e.user.username||e.user.username===c.username?(a(v(e)),a(k("blog '".concat(e.title,"' by ").concat(e.author," deleted"),5)),i.push("/")):f.deleteBlog(e.id).catch((function(e){a(E(e.response.data.error,5))})))}(o)},children:"remove"}),Object(r.jsxs)("div",{children:[Object(r.jsx)("h4",{children:"Comments"}),Object(r.jsx)(je,{id:o.id}),Object(r.jsx)("ul",{children:o.comments.map((function(e,t){return Object(r.jsx)("li",{children:e},t)}))})]})]})},pe=n(162),he=n(163),Oe=function(e){var t=e.user,n=e.token;return Object(r.jsx)("div",{children:Object(r.jsx)(pe.a,{position:"static",children:Object(r.jsxs)(he.a,{children:[Object(r.jsx)(X.a,{color:"inherit",component:K.b,to:"/",children:"blogs"}),Object(r.jsx)(X.a,{color:"inherit",component:K.b,to:"/users",children:"users"}),null!==t&&null!==n?Object(r.jsxs)("span",{children:[t.username," logged in ",Object(r.jsx)(ie,{})]}):Object(r.jsxs)("div",{children:[Object(r.jsx)(X.a,{color:"inherit",component:K.b,to:"/login",children:"login"}),Object(r.jsx)(X.a,{color:"inherit",component:K.b,to:"/signup",children:"signup"})]})]})})})},fe=function(){var e=null,t=Object(M.b)(),n=Object(M.c)((function(e){return e.user})),a=window.localStorage.getItem("loggedBlogappUser");return null!==a&&(e=a.token),Object(c.useEffect)((function(){t(function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=window.localStorage.getItem("loggedBlogappUser"),r=null,n&&(r=JSON.parse(n),f.setToken(r.token)),t({type:"GET_TOKEN",user:r});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[t]),Object(c.useEffect)((function(){t(function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[t]),Object(r.jsx)(Q.a,{children:Object(r.jsxs)("div",{className:"container",children:[Object(r.jsx)(Oe,{user:n,token:e}),Object(r.jsx)(oe,{}),Object(r.jsxs)(re.c,{children:[Object(r.jsx)(re.a,{path:"/users/:id",children:Object(r.jsx)(de,{})}),Object(r.jsx)(re.a,{path:"/blogs/:id",children:Object(r.jsx)(be,{})}),Object(r.jsx)(re.a,{path:"/login",children:Object(r.jsx)(ce,{})}),Object(r.jsx)(re.a,{path:"/signup",children:Object(r.jsx)(ae,{})}),Object(r.jsx)(re.a,{path:"/users",children:Object(r.jsx)(le,{})}),Object(r.jsx)(re.a,{path:"/",children:n?Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:"Blog App"}),Object(r.jsx)(ne,{}),Object(r.jsx)(Y,{user:n})]}):Object(r.jsxs)("div",{children:[Object(r.jsx)("h2",{children:"You're not logged in. Please login"}),Object(r.jsx)(re.a,{path:"/login",children:Object(r.jsx)(ce,{})})]})})]})]})})};n(120);s.a.render(Object(r.jsx)(M.a,{store:G,children:Object(r.jsx)(K.a,{children:Object(r.jsx)(fe,{})})}),document.getElementById("root"))}},[[121,1,2]]]);
//# sourceMappingURL=main.190e3c26.chunk.js.map